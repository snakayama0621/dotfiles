# ============================================================================
# AeroSpace 設定ファイル - タイル型ウィンドウマネージャー
# ============================================================================
# 公式ドキュメント: https://nikitabobko.github.io/AeroSpace/commands
# 設定ファイルの配置場所: ~/.aerospace.toml

# ----------------------------------------------------------------------------
# 1. 起動時設定
# ----------------------------------------------------------------------------

# ログイン後に実行するコマンド（start-at-login = true が必要）
after-login-command = []

# AeroSpace起動後に実行するコマンド
after-startup-command = [
  'exec-and-forget borders',      # ウィンドウボーダー表示
  'exec-and-forget sketchybar',   # ステータスバー起動
]

# ワークスペース変更時にsketchybarへ通知
exec-on-workspace-change = [
  '/bin/bash',
  '-c',
  'sketchybar --trigger aerospace_workspace_change FOCUSED_WORKSPACE=$AEROSPACE_FOCUSED_WORKSPACE',
]

# ログイン時に自動起動
start-at-login = false

# ----------------------------------------------------------------------------
# 2. 正規化・レイアウト設定
# ----------------------------------------------------------------------------

# コンテナの正規化（ネストしたコンテナを平坦化）
enable-normalization-flatten-containers = true
enable-normalization-opposite-orientation-for-nested-containers = true

# アコーディオンレイアウトのパディング（0で無効化）
accordion-padding = 30

# デフォルトレイアウト: tiles | accordion
default-root-container-layout = 'tiles'

# デフォルトの向き: horizontal | vertical | auto
# auto: 横長モニタ→horizontal、縦長モニタ→vertical
default-root-container-orientation = 'auto'

# ----------------------------------------------------------------------------
# 3. マウス・キーボード設定
# ----------------------------------------------------------------------------

# フォーカスモニタ変更時にマウスを中央に移動
on-focused-monitor-changed = ['move-mouse monitor-lazy-center']

# macOSの「アプリケーションを隠す」機能を自動解除（cmd-h誤操作防止）
automatically-unhide-macos-hidden-apps = false

# キーボードレイアウト: qwerty | dvorak
[key-mapping]
preset = 'qwerty'

# ----------------------------------------------------------------------------
# 4. ギャップ設定（ウィンドウ間隔）
# ----------------------------------------------------------------------------

[gaps]
# ウィンドウ間の内側ギャップ
inner.horizontal = 5
inner.vertical = 5

# モニタ端の外側ギャップ
outer.left = 5
outer.bottom = 5
outer.right = 5

# 上部ギャップ（sketchybar用にモニタ別設定）
outer.top = [
  { monitor.'DELL S2722DGM' = 35 },
  { monitor.24N1 = 35 },
  { monitor.'BenQ XL2410T' = 35 },
  { monitor.'XG49WCR' = 35 },
  { monitor.'Built-in Retina Display' = 35 },
  5,  # デフォルト値
]

# ----------------------------------------------------------------------------
# 5. メインモード キーバインド
# ----------------------------------------------------------------------------
[mode.main.binding]

# 5.1 レイアウト切替
alt-slash = 'layout tiles horizontal vertical'     # タイル: 水平/垂直切替
alt-comma = 'layout accordion horizontal vertical' # アコーディオン: 水平/垂直切替

# 5.2 フォーカス移動（Vim風キーバインド）
alt-h = 'focus left'   # 左のウィンドウへ
alt-j = 'focus down'   # 下のウィンドウへ
alt-k = 'focus up'     # 上のウィンドウへ
alt-l = 'focus right'  # 右のウィンドウへ

# 5.3 ウィンドウ移動
alt-shift-h = 'move left'   # ウィンドウを左へ
alt-shift-j = 'move down'   # ウィンドウを下へ
alt-shift-k = 'move up'     # ウィンドウを上へ
alt-shift-l = 'move right'  # ウィンドウを右へ

# 5.4 リサイズ
alt-shift-minus = 'resize smart -50'  # 縮小
alt-shift-equal = 'resize smart +50'  # 拡大

# 5.5 ワークスペース切替（数字キー）
alt-1 = 'workspace 1'
alt-2 = 'workspace 2'
alt-3 = 'workspace 3'
alt-4 = 'workspace 4'
alt-5 = 'workspace 5'
alt-6 = 'workspace 6'
alt-7 = 'workspace 7'
alt-8 = 'workspace 8'
alt-9 = 'workspace 9'

# 5.5 ワークスペース切替（アルファベットキー）
alt-a = 'workspace A'
alt-b = 'workspace B'
alt-c = 'workspace C'
alt-d = 'workspace D'
alt-e = 'workspace E'
alt-f = 'workspace F'
alt-g = 'workspace G'
alt-i = 'workspace I'
alt-m = 'workspace M'
alt-n = 'workspace N'
alt-o = 'workspace O'
alt-p = 'workspace P'
alt-q = 'workspace Q'
alt-r = 'workspace R'
alt-s = 'workspace S'
alt-t = 'workspace T'
alt-u = 'workspace U'
alt-v = 'workspace V'
alt-w = 'workspace W'
alt-x = 'workspace X'
alt-y = 'workspace Y'
alt-z = 'workspace Z'

# 5.6 ウィンドウをワークスペースへ移動（数字キー）
alt-shift-1 = 'move-node-to-workspace 1'
alt-shift-2 = 'move-node-to-workspace 2'
alt-shift-3 = 'move-node-to-workspace 3'
alt-shift-4 = 'move-node-to-workspace 4'
alt-shift-5 = 'move-node-to-workspace 5'
alt-shift-6 = 'move-node-to-workspace 6'
alt-shift-7 = 'move-node-to-workspace 7'
alt-shift-8 = 'move-node-to-workspace 8'
alt-shift-9 = 'move-node-to-workspace 9'

# 5.6 ウィンドウをワークスペースへ移動（アルファベットキー）
alt-shift-a = 'move-node-to-workspace A'
alt-shift-b = 'move-node-to-workspace B'
alt-shift-c = 'move-node-to-workspace C'
alt-shift-d = 'move-node-to-workspace D'
alt-shift-e = 'move-node-to-workspace E'
alt-shift-f = 'move-node-to-workspace F'
alt-shift-g = 'move-node-to-workspace G'
alt-shift-i = 'move-node-to-workspace I'
alt-shift-m = 'move-node-to-workspace M'
alt-shift-n = 'move-node-to-workspace N'
alt-shift-o = 'move-node-to-workspace O'
alt-shift-p = 'move-node-to-workspace P'
alt-shift-q = 'move-node-to-workspace Q'
alt-shift-r = 'move-node-to-workspace R'
alt-shift-s = 'move-node-to-workspace S'
alt-shift-t = 'move-node-to-workspace T'
alt-shift-u = 'move-node-to-workspace U'
alt-shift-v = 'move-node-to-workspace V'
alt-shift-w = 'move-node-to-workspace W'
alt-shift-x = 'move-node-to-workspace X'
alt-shift-y = 'move-node-to-workspace Y'
alt-shift-z = 'move-node-to-workspace Z'

# 5.7 その他
alt-tab = 'workspace-back-and-forth'                      # 前のワークスペースに戻る
alt-shift-tab = 'move-workspace-to-monitor --wrap-around next'  # ワークスペースを次のモニタへ
alt-shift-semicolon = 'mode service'                      # サービスモードへ切替

# ----------------------------------------------------------------------------
# 6. サービスモード キーバインド
# ----------------------------------------------------------------------------
# alt + shift + ; でサービスモードに入る
[mode.service.binding]

esc = ['reload-config', 'mode main']              # 設定リロードしてメインモードへ
r = ['flatten-workspace-tree', 'mode main']       # レイアウトリセット
f = ['layout floating tiling', 'mode main']       # フローティング/タイリング切替

# ウィンドウ結合（サービスモード中）
alt-shift-h = ['join-with left', 'mode main']
alt-shift-j = ['join-with down', 'mode main']
alt-shift-k = ['join-with up', 'mode main']
alt-shift-l = ['join-with right', 'mode main']
